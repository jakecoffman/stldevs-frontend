<link rel="import" href="/bower_components/iron-ajax/iron-ajax.html">

<dom-module id="top-developers">

  <style>
    :host {
      display: block;
    }
    table {
      width: 100%;
    }
    th {
      text-align: left;
    }
    #lastrun {
      font-style: italic;
    }
  </style>
  <template>
    <h2 class="paper-font-display2">Top Developers</h2>

    <p id="lastrun">As of: <span>{{_date(data.lastrun)}}</span></p>

    <table>
      <thead>
      <tr>
        <th>Developer</th>
        <th>Total Stars</th>
        <th>Total Forks</th>
        <th>Followers</th>
      </tr>
      </thead>
      <tbody>
      <template is="dom-repeat" items="{{data.devs}}">
        <tr>
          <td>
            <a href$="{{_getProfileLink(item.Login)}}">{{item.Name}}</a>
          </td>
          <td>{{item.Stars}}</td>
          <td>{{item.Forks}}</td>
          <td>{{item.Followers}}</td>
        </tr>
      </template>
      </tbody>
    </table>

    <iron-ajax auto
               url="http://localhost/topdevs"
               handle-as="json"
               last-response="{{data}}"></iron-ajax>
  </template>

  <script>
    (function () {
      Polymer({
        is: 'top-developers',
        _getProfileLink: function(login) {
          return '/profile/' + login;
        },
        _date: function(date) {
          return new Date(date)
        }
      });
    })();
  </script>

</dom-module>
